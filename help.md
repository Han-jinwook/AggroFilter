# 어그로필터 프로젝트 작업 현황 (2026-01-10 기준)

## 최근 주요 작업

### 1. AI 분석 엔진 긴급 복구 및 업그레이드 (완료)
- **문제점**: 기존 `gemini-1.5-pro`/`flash` 모델의 404/429 에러 및 타임아웃으로 인한 분석 실패.
- **조치**: 
  - Primary Model: **`gemini-2.5-flash`** (최신 고성능)
  - Fallback Model: **`gemini-2.0-flash-lite`** (안정성 확보)
  - Translation Model: **`gemini-2.5-flash-lite`** (속도 최적화)
  - **Fail-safe 로직 적용**: 주제 표준화(임베딩) 과정이 실패하거나 5초 이상 지연되어도 분석 결과는 정상 반환되도록 수정.
- **결과**: `scripts/api_test.mjs` 테스트 결과, 분석 및 결과 조회가 정상적으로 수행됨을 확인.

### 2. 분석 실패 원인 디버깅 (해결됨)
- **원인**: 
  1. `gemini-1.5` 계열 모델의 API 접근 불가(404).
  2. `gemini-2.0` 사용 시 간헐적인 429(Quota) 에러.
  3. 주제 표준화 단계의 타임아웃으로 인한 DB 트랜잭션 롤백 가능성.
- **해결**: 모델 최신화 및 예외 처리 로직 강화로 해결.

### 3. 프롬프트 엔지니어링 고도화
- **어그로성 평가 로직 개편**: '팩트의 무게'와 '표현의 무게' 사이의 **괴리감(Gap)**을 측정하는 상대적 평가 로직을 도입하여, 내용이 정확하더라도 제목이나 썸네일이 과장되면 어그로 점수를 높게 부여하도록 개선했습니다.
- **주제 분류 정확도 향상**: '재난 이슈'와 '기후 변화'처럼 혼동하기 쉬운 주제를 명확히 구분하도록 AI의 분석 기준을 강화했습니다. (예: 지진은 '재난 이슈'로 분류)

## 현재 상태
- **✅ 모든 시스템 정상 가동 중**
- 개발 서버: 실행 중 (`npm run dev`)
- AI 분석: **성공** (Gemini 2.5 Flash 적용됨)

---
### 2026-01-07: 모든 분석 실패 현상
- 원인 추정: `gemini-2.0-flash-exp` 모델의 불안정성(503) 및 서버리스 타임아웃 가능성.
- 추가 발견: `gemini-1.5-flash`는 현재 환경에서 404 에러 발생. `gemini-2.0`은 429 에러.

